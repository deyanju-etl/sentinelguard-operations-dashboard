

SELECT *
FROM [Operations from Power Bi]
;

-- for total incidents 

SELECT SUM(incidents_reported) AS Total_incidents 
FROM [Operations from Power Bi]
;


-- average response time 

SELECT ROUND(AVG(response_time_minutes),2) AS avg_response_time 
FROM [Operations from Power Bi]
;


-- average client satisfaction 

SELECT ROUND(AVG(client_satisfaction_score),2) AS avg_client_satisfaction 
FROM [Operations from Power Bi]
;


-- average operational efficiency score 

SELECT ROUND(AVG(efficiency_score),2) AS avg_efficiency_score
FROM [Operations from Power Bi]
;


-- ranking incidents by location 

SELECT 
    location,
    SUM(incidents_reported) AS num_of_incidents,
    RANK() OVER (ORDER BY SUM(incidents_reported) DESC) AS location_rank
FROM [Operations from Power Bi]
GROUP BY location
ORDER BY num_of_incidents DESC
;

-- another way to write it without the rank 

SELECT location, SUM(incidents_reported) AS total_incidents
FROM [Operations from Power Bi]
GROUP BY location
ORDER BY total_incidents DESC
;


-- incident type breakdown

SELECT incident_type, COUNT(*) AS total_cases
FROM [Operations from Power Bi]
GROUP BY incident_type
ORDER BY total_cases DESC
;


-- profit margin by deployment type and percentage 

SELECT deployment_type, ROUND(SUM(profit_margin),2 ) AS total_profit,
        ROUND((SUM(profit_margin) * 100.0) / SUM(SUM(profit_margin)) OVER (),2) AS percentage_contribution
FROM [Operations from Power Bi]
GROUP BY deployment_type
ORDER BY total_profit DESC
;

-- total contract vs contract value 

SELECT 
    FORMAT(date, 'MMM-yyyy') AS month,
    SUM(contract_value) AS total_contract_value,
    SUM(total_cost) AS total_cost
FROM [Operations from Power Bi]
GROUP BY FORMAT(date, 'MMM-yyyy')
ORDER BY MIN(date)
;




